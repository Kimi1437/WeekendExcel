using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WeekendExcel
{
    public partial class LogonStatistics : Form
    {
        public LogonStatistics()
        {
            InitializeComponent();
        }
        /// <summary>
        /// 查询实例数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button1_Click(object sender, EventArgs e)
        {
            Progress fm = new Progress(0, 100);
            fm.Show(this);//设置父窗体
            fm.setPos(1,"开始查询");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            
            DataTable resultData = new DataTable();//最终的表格 
            DataTable dataData = new DataTable();//临时的表格数据
            string sql = "";
            string dateBegin = Convert.ToString(dateTimePicker1.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            string dateEnd = Convert.ToString(dateTimePicker2.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            fm.setPos(30, "准备查询数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            #region sql语言
            sql = @"select  count( distinct incident) AS countNumber ,'HQ_H07请假申请单' as name from TASKS where processname in  ('HQ_H07请假申请单') and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                                              'SYSTEMUSER','EULTIMUS_FLOBOT',                                              'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M01产品上市计划_v1' as name from TASKS where processname in ('HQ_M01产品上市计划_v1') and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT','SYSTEMUSER','EULTIMUS_FLOBOT','ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M02料号申请单_v3' as name from TASKS where processname in ('HQ_M02料号申请单_v3')and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT','SYSTEMUSER','EULTIMUS_FLOBOT','ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M04销售包装设计确认单_v4' as name from TASKS where processname in ('HQ_M04销售包装设计确认单_v4') and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_M07产品基本资料通知表_v4' as name from TASKS where processname in  ( 'HQ_M07产品基本资料通知表_v4' )  and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_M08价格通知表_v3' as name from TASKS where processname in ( 'HQ_M08价格通知表_v3' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M11OEM产品开发评估计划_v1' as name  from TASKS where processname in ( 'HQ_M11OEM产品开发评估计划_v1' )  and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_M13包装规范表_v1' as name from TASKS where processname in ( 'HQ_M13包装规范表_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M14打样需求单_v1' as name from TASKS where processname in ( 'HQ_M14打样需求单_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber  ,'HQ_M15开发需求单_v1' as name from TASKS where processname in ( 'HQ_M15开发需求单_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M16询价单_v1' as name from TASKS where processname in ( 'HQ_M16询价单_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M17成品请购计划表_v1' as name from TASKS where processname in (  'HQ_M17成品请购计划表_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT','SYSTEMUSER','EULTIMUS_FLOBOT','ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_C01原料异常反应及特采单' as name from TASKS where processname in ( 'HQ_C01原料异常反应及特采单' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF  ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_H01出差申请流程' as name from TASKS where processname in ( 'HQ_H01出差申请流程'  ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_H02差旅费用报销流程' as name from TASKS where processname in  ( 'HQ_H02差旅费用报销流程' ) and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_H05总部通用帐号、终端申请表' as name from TASKS where processname in ( 'HQ_H05总部通用帐号、终端申请表' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_H06加班申请单' as name from TASKS where processname in ( 'HQ_H06加班申请单' )  and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',  'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_H10离职程序表' as name from TASKS where processname in ( 'HQ_H10离职程序表' )  and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_H13公出记录单' as name from TASKS where processname in ( 'HQ_H13公出记录单' ) and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident)  AS countNumber,'HQ_K01消费者渠道客诉立案流程_v1' as name from TASKS where processname in  ( 'HQ_K01消费者渠道客诉立案流程_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_K01消费者渠道客诉立案流程_v1对口人' as name  from TASKS where processname in  ( 'HQ_K01消费者渠道客诉立案流程_v1对口人' ) and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_K02消费者客诉理赔流程_v1' as name from TASKS where processname in ( 'HQ_K02消费者客诉理赔流程_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_M03询价打样申请单_v3' as name  from TASKS where processname in ( 'HQ_M03询价打样申请单_v3' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_M05原物料请购计划表_v1' as name from TASKS where processname in ( 'HQ_M05原物料请购计划表_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_M06物料请购单_v2' as name from TASKS where processname in ( 'HQ_M06物料请购单_v2' ) and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_M09推广辅助物基本资料通知表_v2' as name from TASKS where processname in ( 'HQ_M09推广辅助物基本资料通知表_v2' ) and   status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HHQ_M12BOM申请表_v1' as name from TASKS where processname in ( 'HHQ_M12BOM申请表_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_P02供应商合同续签审批流程' as name from TASKS where processname in ( 'HQ_P02供应商合同续签审批流程' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL    select  count( distinct incident) AS countNumber ,'HQ_P03新采购供应商审批流程' as name from TASKS where processname in ( 'HQ_P03新采购供应商审批流程' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber ,'HQ_P04采购料件价格审批流程_v3' as name from TASKS where processname in ( 'HQ_P04采购料件价格审批流程_v3' )  and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT','ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_H09离职申请单' as name from TASKS where processname in ( 'HQ_H09离职申请单'  ) and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_H04总部固定资产验收流程' as name from TASKS where processname in ( 'HQ_H04总部固定资产验收流程' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_X01采购料件价格审批-辅助物赠品流程_v1' as name from TASKS where processname in ( 'HQ_X01采购料件价格审批-辅助物赠品流程_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT',  'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL    select  count( distinct incident) AS countNumber,'HQ_X03询价打样申请单-辅助物赠品_v1' as name from TASKS where processname in  ( 'HQ_X03询价打样申请单-辅助物赠品_v1' )  and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')  and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL   select  count( distinct incident) AS countNumber,'HQ_H03总部固定资产请购流程' as name  from TASKS where processname in ( 'HQ_H03总部固定资产请购流程' ) and  status=3  and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' UNION ALL   select  count( distinct incident) AS countNumber,'HQ_X06物料请购单_v1' as name from TASKS where processname in ( 'HQ_X06物料请购单_v1' ) and  status=3 and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT', 'SYSTEMUSER','EULTIMUS_FLOBOT', 'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT') and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'";
            #endregion
            fm.setPos(40, "开始查询数据");//设置进度条位置
            Thread.Sleep(500);//睡眠时间为100
            fm.setPos(60, "开始疯狂查询数据数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            dataData = ConSQL(sql);
            resultData = dataData.Clone();
            object[] obj = new object[dataData.Columns.Count];
            for (int i = 0; i < dataData.Rows.Count; i++)
            {
                fm.setPos(80+i, "开始拼装数据数据");//设置进度条位置
                Thread.Sleep(100);//睡眠时间为100
                dataData.Rows[i].ItemArray.CopyTo(obj, 0);
                resultData.Rows.Add(obj);
            }
            dataGridView1.DataSource = resultData;
            fm.Close();//关闭进度条窗体
        }
        /// <summary>
        /// 查询节点数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button2_Click(object sender, EventArgs e)
        {
            Progress fm = new Progress(0, 100);
            fm.Show(this);//设置父窗体
            fm.setPos(1, "开始查询");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            DataTable resultData = new DataTable();//最终的表格 
            DataTable dataData = new DataTable();//临时的表格数据
            string sql = "";
            string dateBegin = Convert.ToString(dateTimePicker1.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            string dateEnd = Convert.ToString(dateTimePicker2.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            fm.setPos(30, "准备查询数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            #region 查询节点数SQL
            sql = @"   select  count( 1) as count,'HQ_H07请假申请单' as name  from TASKS where processname in('HQ_H07请假申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M01产品上市计划_v1' as name from TASKS where processname in('HQ_M01产品上市计划_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M02料号申请单_v3' as name from TASKS where processname in('HQ_M02料号申请单_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M04销售包装设计确认单_v4' as name from TASKS where processname in('HQ_M04销售包装设计确认单_v4')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M07产品基本资料通知表_v4' as name from TASKS where processname in('HQ_M07产品基本资料通知表_v4')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M08价格通知表_v3' as name from TASKS where processname in('HQ_M08价格通知表_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M11OEM产品开发评估计划_v1' as name from TASKS where processname in('HQ_M11OEM产品开发评估计划_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M13包装规范表_v1' as name from TASKS where processname in('HQ_M13包装规范表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M14打样需求单_v1' as name from TASKS where processname in('HQ_M14打样需求单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M15开发需求单_v1' as name from TASKS where processname in('HQ_M15开发需求单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M16询价单_v1' as name from TASKS where processname in('HQ_M16询价单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M17成品请购计划表_v1' as name from TASKS where processname in('HQ_M17成品请购计划表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_C01原料异常反应及特采单' as name from TASKS where processname in('HQ_C01原料异常反应及特采单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H01出差申请流程' as name from TASKS where processname in('HQ_H01出差申请流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H02差旅费用报销流程' as name from TASKS where processname in('HQ_H02差旅费用报销流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H05总部通用帐号、终端申请表' as name from TASKS where processname in('HQ_H05总部通用帐号、终端申请表')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H06加班申请单' as name from TASKS where processname in('HQ_H06加班申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H10离职程序表' as name from TASKS where processname in('HQ_H10离职程序表')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H13公出记录单' as name from TASKS where processname in('HQ_H13公出记录单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_K01消费者渠道客诉立案流程_v1' as name from TASKS where processname in('HQ_K01消费者渠道客诉立案流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_K01消费者渠道客诉立案流程_v1对口人' as name from TASKS where processname in('HQ_K01消费者渠道客诉立案流程_v1对口人')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_K02消费者客诉理赔流程_v1' as name from TASKS where processname in('HQ_K02消费者客诉理赔流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M03询价打样申请单_v3' as name from TASKS where processname in('HQ_M03询价打样申请单_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M05原物料请购计划表_v1' as name from TASKS where processname in('HQ_M05原物料请购计划表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M06物料请购单_v2' as name from TASKS where processname in('HQ_M06物料请购单_v2')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count(1)  as count,'HQ_M09推广辅助物基本资料通知表_v2' as name from TASKS where processname in('HQ_M09推广辅助物基本资料通知表_v2')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_M12BOM申请表_v1' as name from TASKS where processname in('HQ_M12BOM申请表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_P02供应商合同续签审批流程' as name from TASKS where processname in('HQ_P02供应商合同续签审批流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_P03新采购供应商审批流程' as name from TASKS where processname in('HQ_P03新采购供应商审批流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_P04采购料件价格审批流程_v3' as name from TASKS where processname in('HQ_P04采购料件价格审批流程_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H09离职申请单' as name from TASKS where processname in('HQ_H09离职申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H04总部固定资产验收流程' as name from TASKS where processname in('HQ_H04总部固定资产验收流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_X01采购料件价格审批' as name from TASKS where processname in('HQ_X01采购料件价格审批-辅助物赠品流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_X03询价打样申请单' as name from TASKS where processname in('HQ_X03询价打样申请单-辅助物赠品_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_H03总部固定资产请购流程' as name from TASKS where processname in('HQ_H03总部固定资产请购流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'  UNION ALL  select  count( 1) as count,'HQ_X06物料请购单_v1' as name from TASKS where processname in('HQ_X06物料请购单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'";
            #endregion
            fm.setPos(40, "开始查询数据");//设置进度条位置
            Thread.Sleep(500);//睡眠时间为100
            fm.setPos(60, "开始疯狂查询数据数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            dataData = ConSQL(sql);
            resultData = dataData.Clone();
            object[] obj = new object[dataData.Columns.Count];
            for (int i = 0; i < dataData.Rows.Count; i++)
            {
                fm.setPos(80 + i, "开始拼装数据数据");//设置进度条位置
                Thread.Sleep(100);//睡眠时间为100
                dataData.Rows[i].ItemArray.CopyTo(obj, 0);
                resultData.Rows.Add(obj);
            }
            dataGridView2.DataSource = resultData;
            fm.Close();//关闭进度条窗体
        }
        /// <summary>
        /// APP端审批节点数查询
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button3_Click(object sender, EventArgs e)
        {
            Progress fm = new Progress(0, 100);
            fm.Show(this);//设置父窗体
            fm.setPos(1, "开始查询");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            DataTable resultData = new DataTable();//最终的表格 
            DataTable dataData = new DataTable();//临时的表格数据
            string sql = "";
            string dateBegin = Convert.ToString(dateTimePicker1.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            string dateEnd = Convert.ToString(dateTimePicker2.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            fm.setPos(30, "准备查询数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            #region APP端审批节点数查询SQL 
            sql = @" select count(*)as number,'HQ_H07请假申请单' as name from BPMAPP_LOG where processname='HQ_H07请假申请单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H07请假申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )  UNION ALL  select count(*)as number,'HQ_M01产品上市计划_v1' as name from BPMAPP_LOG where processname='HQ_M01产品上市计划_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M01产品上市计划_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M02料号申请单_v3' as name from BPMAPP_LOG where processname='HQ_M02料号申请单_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M02料号申请单_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M04销售包装设计确认单_v4' as name from BPMAPP_LOG where processname='HQ_M04销售包装设计确认单_v4'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M04销售包装设计确认单_v4')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M07产品基本资料通知表_v4' as name from BPMAPP_LOG where processname='HQ_M07产品基本资料通知表_v4'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M07产品基本资料通知表_v4')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M08价格通知表_v3' as name from BPMAPP_LOG where processname='HQ_M08价格通知表_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M08价格通知表_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M11OEM产品开发评估计划_v1' as name from BPMAPP_LOG where processname='HQ_M11OEM产品开发评估计划_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M11OEM产品开发评估计划_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M13包装规范表_v1' as name from BPMAPP_LOG where processname='HQ_M13包装规范表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M13包装规范表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M14打样需求单_v1' as name from BPMAPP_LOG where processname='HQ_M14打样需求单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M14打样需求单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M15开发需求单_v1' as name from BPMAPP_LOG where processname='HQ_M15开发需求单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M15开发需求单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M16询价单_v1' as name from BPMAPP_LOG where processname='HQ_M16询价单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M16询价单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M17成品请购计划表_v1' as name from BPMAPP_LOG where processname='HQ_M17成品请购计划表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M17成品请购计划表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_C01原料异常反应及特采单' as name from BPMAPP_LOG where processname='HQ_C01原料异常反应及特采单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_C01原料异常反应及特采单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H01出差申请流程' as name from BPMAPP_LOG where processname='HQ_H01出差申请流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H01出差申请流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H02差旅费用报销流程' as name from BPMAPP_LOG where processname='HQ_H02差旅费用报销流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H02差旅费用报销流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H05总部通用帐号、终端申请表' as name from BPMAPP_LOG where processname='HQ_H05总部通用帐号、终端申请表'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H05总部通用帐号、终端申请表')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H06加班申请单' as name from BPMAPP_LOG where processname='HQ_H06加班申请单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H06加班申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H10离职程序表' as name from BPMAPP_LOG where processname='HQ_H10离职程序表'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H10离职程序表')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H13公出记录单' as name from BPMAPP_LOG where processname='HQ_H13公出记录单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H13公出记录单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_K01消费者渠道客诉立案流程_v1' as name from BPMAPP_LOG where processname='HQ_K01消费者渠道客诉立案流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_K01消费者渠道客诉立案流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_K01消费者渠道客诉立案流程_v1' as name from BPMAPP_LOG where processname='HQ_K01消费者渠道客诉立案流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_K01消费者渠道客诉立案流程_v1对口人')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_K02消费者客诉理赔流程_v1' as name from BPMAPP_LOG where processname='HQ_K02消费者客诉理赔流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_K02消费者客诉理赔流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M03询价打样申请单_v3' as name from BPMAPP_LOG where processname='HQ_M03询价打样申请单_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M03询价打样申请单_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HHQ_M05原物料请购计划表_v1' as name from BPMAPP_LOG where processname='HHQ_M05原物料请购计划表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M05原物料请购计划表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M06物料请购单_v2' as name from BPMAPP_LOG where processname='HQ_M06物料请购单_v2'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M06物料请购单_v2')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M09推广辅助物基本资料通知表_v2' as name from BPMAPP_LOG where processname='HQ_M09推广辅助物基本资料通知表_v2'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M09推广辅助物基本资料通知表_v2')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_M12BOM申请表_v1' as name from BPMAPP_LOG where processname='HQ_M12BOM申请表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M12BOM申请表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_P02供应商合同续签审批流程' as name from BPMAPP_LOG where processname='HQ_P02供应商合同续签审批流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_P02供应商合同续签审批流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_P03新采购供应商审批流程' as name from BPMAPP_LOG where processname='HQ_P03新采购供应商审批流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_P03新采购供应商审批流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_P04采购料件价格审批流程_v3' as name from BPMAPP_LOG where processname='HQ_P04采购料件价格审批流程_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_P04采购料件价格审批流程_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H09离职申请单' as name from BPMAPP_LOG where processname='HQ_H09离职申请单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H09离职申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H04总部固定资产验收流程' as name from BPMAPP_LOG where processname='HQ_H04总部固定资产验收流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H04总部固定资产验收流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_X01采购料件价格审批-辅助物赠品流程_v1' as name from BPMAPP_LOG where processname='HQ_X01采购料件价格审批-辅助物赠品流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_X01采购料件价格审批-辅助物赠品流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_X03询价打样申请单-辅助物赠品_v1' as name from BPMAPP_LOG where processname='HQ_X03询价打样申请单-辅助物赠品_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_X03询价打样申请单-辅助物赠品_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_H03总部固定资产请购流程' as name from BPMAPP_LOG where processname='HQ_H03总部固定资产请购流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H03总部固定资产请购流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(*)as number,'HQ_X06物料请购单_v1' as name from BPMAPP_LOG where processname='HQ_X06物料请购单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_X06物料请购单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )";
            #endregion
            fm.setPos(40, "开始查询数据");//设置进度条位置
            Thread.Sleep(500);//睡眠时间为100
            fm.setPos(60, "开始疯狂查询数据数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            dataData = ConSQLTOP(sql);
            resultData = dataData.Clone();
            object[] obj = new object[dataData.Columns.Count];
            for (int i = 0; i < dataData.Rows.Count; i++)
            {
                fm.setPos(80 + i, "开始拼装数据数据");//设置进度条位置
                Thread.Sleep(100);//睡眠时间为100
                dataData.Rows[i].ItemArray.CopyTo(obj, 0);
                resultData.Rows.Add(obj);
            }
            dataGridView3.DataSource = resultData;
            fm.Close();//关闭进度条窗体
        }
        /// <summary>
        /// App端审批实例数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button4_Click(object sender, EventArgs e)
        {
            Progress fm = new Progress(0, 100);
            fm.Show(this);//设置父窗体
            fm.setPos(1, "开始查询");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            DataTable resultData = new DataTable();//最终的表格 
            DataTable dataData = new DataTable();//临时的表格数据
            string sql = "";
            string dateBegin = Convert.ToString(dateTimePicker1.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            string dateEnd = Convert.ToString(dateTimePicker2.Text).Replace("年", "-").Replace("月", "-").Replace("日", "");
            fm.setPos(30, "准备查询数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            #region App端审批实例数SQL
            sql = @" select count(distinct indenceid) as number,'HQ_H07请假申请单' as name from BPMAPP_LOG where processname='HQ_H07请假申请单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H07请假申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M01产品上市计划_v1' as name from BPMAPP_LOG where processname='HQ_M01产品上市计划_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M01产品上市计划_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M02料号申请单_v3' as name from BPMAPP_LOG where processname='HQ_M02料号申请单_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M02料号申请单_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M04销售包装设计确认单_v4' as name from BPMAPP_LOG where processname='HQ_M04销售包装设计确认单_v4'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M04销售包装设计确认单_v4')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M07产品基本资料通知表_v4' as name from BPMAPP_LOG where processname='HQ_M07产品基本资料通知表_v4'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M07产品基本资料通知表_v4')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M08价格通知表_v3' as name from BPMAPP_LOG where processname='HQ_M08价格通知表_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M08价格通知表_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M11OEM产品开发评估计划_v1' as name from BPMAPP_LOG where processname='HQ_M11OEM产品开发评估计划_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M11OEM产品开发评估计划_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M13包装规范表_v1' as name from BPMAPP_LOG where processname='HQ_M13包装规范表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M13包装规范表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M14打样需求单_v1' as name from BPMAPP_LOG where processname='HQ_M14打样需求单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M14打样需求单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M15开发需求单_v1' as name from BPMAPP_LOG where processname='HQ_M15开发需求单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M15开发需求单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M16询价单_v1' as name from BPMAPP_LOG where processname='HQ_M16询价单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M16询价单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M17成品请购计划表_v1' as name from BPMAPP_LOG where processname='HQ_M17成品请购计划表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M17成品请购计划表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_C01原料异常反应及特采单' as name from BPMAPP_LOG where processname='HQ_C01原料异常反应及特采单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_C01原料异常反应及特采单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_H01出差申请流程' as name from BPMAPP_LOG where processname='HQ_H01出差申请流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H01出差申请流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_H02差旅费用报销流程' as name from BPMAPP_LOG where processname='HQ_H02差旅费用报销流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H02差旅费用报销流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_H05总部通用帐号、终端申请表' as name from BPMAPP_LOG where processname='HQ_H05总部通用帐号、终端申请表'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H05总部通用帐号、终端申请表')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_H06加班申请单' as name from BPMAPP_LOG where processname='HQ_H06加班申请单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HHQ_H06加班申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_H10离职程序表' as name from BPMAPP_LOG where processname='HQ_H10离职程序表'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H10离职程序表')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_H13公出记录单' as name from BPMAPP_LOG where processname='HQ_H13公出记录单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H13公出记录单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_K01消费者渠道客诉立案流程_v1' as name from BPMAPP_LOG where processname='HQ_K01消费者渠道客诉立案流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_K01消费者渠道客诉立案流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_K01消费者渠道客诉立案流程_v1对口人' as name from BPMAPP_LOG where processname='HQ_K01消费者渠道客诉立案流程_v1对口人'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_K01消费者渠道客诉立案流程_v1对口人')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_K02消费者客诉理赔流程_v1' as name from BPMAPP_LOG where processname='HQ_K02消费者客诉理赔流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_K02消费者客诉理赔流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M03询价打样申请单_v3' as name from BPMAPP_LOG where processname='HQ_M03询价打样申请单_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M03询价打样申请单_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M05原物料请购计划表_v1' as name from BPMAPP_LOG where processname='HQ_M05原物料请购计划表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M05原物料请购计划表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M06物料请购单_v2' as name from BPMAPP_LOG where processname='HQ_M06物料请购单_v2'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M06物料请购单_v2')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M09推广辅助物基本资料通知表_v2' as name from BPMAPP_LOG where processname='HQ_M09推广辅助物基本资料通知表_v2'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M09推广辅助物基本资料通知表_v2')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_M12BOM申请表_v1' as name from BPMAPP_LOG where processname='HQ_M12BOM申请表_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_M12BOM申请表_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_P02供应商合同续签审批流程' as name from BPMAPP_LOG where processname='HQ_P02供应商合同续签审批流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_P02供应商合同续签审批流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_P03新采购供应商审批流程' as name from BPMAPP_LOG where processname='HQ_P03新采购供应商审批流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_P03新采购供应商审批流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'    )UNION ALL  select count(distinct indenceid) as number,'HQ_P04采购料件价格审批流程_v3' as name from BPMAPP_LOG where processname='HQ_P04采购料件价格审批流程_v3'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_P04采购料件价格审批流程_v3')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "'   )UNION ALL  select count(distinct indenceid) as number,'HQ_H09离职申请单' as name from BPMAPP_LOG where processname='HQ_H09离职申请单'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H09离职申请单')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(distinct indenceid) as number,'HQ_H04总部固定资产验收流程' as name from BPMAPP_LOG where processname='HQ_H04总部固定资产验收流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H04总部固定资产验收流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(distinct indenceid) as number,'HQ_X01采购料件价格审批-辅助物赠品流程_v1' as name from BPMAPP_LOG where processname='HQ_X01采购料件价格审批-辅助物赠品流程_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_X01采购料件价格审批-辅助物赠品流程_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(distinct indenceid) as number,'HQ_X03询价打样申请单-辅助物赠品_v1' as name from BPMAPP_LOG where processname='HQ_X03询价打样申请单-辅助物赠品_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_X03询价打样申请单-辅助物赠品_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' ) UNION ALL  select count(distinct indenceid) as number,'HQ_H03总部固定资产请购流程' as name from BPMAPP_LOG where processname='HQ_H03总部固定资产请购流程'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_H03总部固定资产请购流程')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )UNION ALL  select count(distinct indenceid) as number,'HQ_X06物料请购单_v1' as name from BPMAPP_LOG where processname='HQ_X06物料请购单_v1'  and indenceid in(select  distinct incident  from utdbtask where processname in('HQ_X06物料请购单_v1')and  status=3and taskuser not in ( 'NWORKFLOW_WF ','NWORKFLOW_FLOBOT','SWORKFLOW_FLOBOT',                      'SYSTEMUSER','EULTIMUS_FLOBOT',                      'ELULTIMUS_WF','SWORKFLOW_INLINE_FLOBOT','NWORKFLOW_INLINE_FLOBOT')                            and starttime>='" + dateBegin + "'  and endtime<'" + dateEnd + "' )";
            #endregion
            fm.setPos(40, "开始查询数据");//设置进度条位置
            Thread.Sleep(500);//睡眠时间为100
            fm.setPos(60, "开始疯狂查询数据数据");//设置进度条位置
            Thread.Sleep(100);//睡眠时间为100
            dataData = ConSQLTOP(sql);
            resultData = dataData.Clone();
            object[] obj = new object[dataData.Columns.Count];
            for (int i = 0; i < dataData.Rows.Count; i++)
            {
                fm.setPos(80 + i, "开始拼装数据数据");//设置进度条位置
                Thread.Sleep(100);//睡眠时间为100
                dataData.Rows[i].ItemArray.CopyTo(obj, 0);
                resultData.Rows.Add(obj);
            }
            dataGridView4.DataSource = resultData;
            fm.Close();//关闭进度条窗体
        }
        /// <summary>
        /// 连接数据库UltimusDB
        /// </summary>
        /// <param name="sql"></param>
        /// <returns></returns>
        public DataTable ConSQL(string sql)
        {
            String constr = "data source =192.168.80.18; initial catalog = UltimusDB; user id = sa; password =sa";  //连接数据库服务器
            SqlConnection conn = new SqlConnection(constr);//SQL连接类的实例化
            conn.Open();//打开数据库
            SqlDataAdapter find = new SqlDataAdapter(sql, conn);// 创建DataAdapter数据适配器实例，SqlDataAdapter作用是 DataSet和 SQL Server之间的桥接器，用于检索和保存数据
            DataSet save = new DataSet(); //创建DataSet实例
            find.Fill(save, "wu");//  使用DataAdapter的Fill方法(填充)，调用SELECT命令 fill(对象名，"自定义虚拟表名")  
            conn.Close();//关闭数据库
            return save.Tables[0];
        }

        /// <summary>
        /// 连接数据库TOP
        /// </summary>
        /// <param name="sql"></param>
        /// <returns></returns>
        public DataTable ConSQLTOP(string sql)
        {
            String constr = "data source =192.168.80.18; initial catalog = Top; user id = sa; password =sa";  //连接数据库服务器
            SqlConnection conn = new SqlConnection(constr);//SQL连接类的实例化
            conn.Open();//打开数据库
            SqlDataAdapter find = new SqlDataAdapter(sql, conn);// 创建DataAdapter数据适配器实例，SqlDataAdapter作用是 DataSet和 SQL Server之间的桥接器，用于检索和保存数据
            DataSet save = new DataSet(); //创建DataSet实例
            find.Fill(save, "wu");//  使用DataAdapter的Fill方法(填充)，调用SELECT命令 fill(对象名，"自定义虚拟表名")  
            conn.Close();//关闭数据库
            return save.Tables[0];
        }
        /// <summary>
        /// 生成统计报表的功能
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button5_Click(object sender, EventArgs e)
        {
            DataTable dt = new DataTable("OperationExcel");
            dt.Columns.Add("工单/流程名", System.Type.GetType("System.String"));
            dt.Columns.Add("实例数", System.Type.GetType("System.String"));
            dt.Columns.Add("节点数", System.Type.GetType("System.String"));
            dt.Columns.Add("PC端审批节点数", System.Type.GetType("System.String"));
            dt.Columns.Add("PC端审批占比", System.Type.GetType("System.String"));
            dt.Columns.Add("APP端审批节点数", System.Type.GetType("System.String"));
            dt.Columns.Add("APP端审批占比", System.Type.GetType("System.String"));
            dt.Columns.Add("App端审批实例数", System.Type.GetType("System.String"));
            dt.Columns.Add("App端审批实例占比", System.Type.GetType("System.String"));

            DataTable shilishu = dataGridView1.DataSource as DataTable;//实例数
            DataTable jiedianshu = dataGridView2.DataSource as DataTable;//节点数
            DataTable appJiedian = dataGridView3.DataSource as DataTable;//APP端审批节点数
            DataTable appShili = dataGridView4.DataSource as DataTable;//APP端审批实例数
            #region 实例数的值赋值到新表
            DataRow dr2 = null;
            foreach (DataRow row in shilishu.Rows)
            {
                dr2 = dt.NewRow();
                dr2[0] = row["name"];
                dr2[1] = row["countNumber"];
                dt.Rows.Add(dr2);
            }
            #endregion
            #region 节点数的值赋值到新表
            for (int i = 0; i < jiedianshu.Rows.Count; i++)
            {
                dt.Rows[i][2] = jiedianshu.Rows[i]["count"];
            }
            #endregion
            #region APP端审批节点数赋值到新表
            for (int i = 0; i < appJiedian.Rows.Count; i++)
            {
                dt.Rows[i][5] = appJiedian.Rows[i]["number"];
            }
            #endregion
            #region APP端审批实例数赋值到新表
            for (int i = 0; i < appShili.Rows.Count; i++)
            {
                dt.Rows[i][7] = appShili.Rows[i]["number"];
            }
            #endregion


            #region 开始循环表来做计算
            for (int i = 0; i < dt.Rows.Count; i++)
            {
                if (i==20)
                {
                    dt.Rows[i][3] = dt.Rows[i][2];
                }
                else
                {
                    dt.Rows[i][3] = (Convert.ToInt32(dt.Rows[i][2]) - Convert.ToInt32(dt.Rows[i][5])).ToString();//PC端审批节点数
                }
                
                if (Convert.ToInt32(dt.Rows[i][2])==0)
                {
                    dt.Rows[i][4] = "0.00%";
                }
                else
                {
                    dt.Rows[i][4] = Math.Round(Convert.ToDecimal((Convert.ToDecimal(dt.Rows[i][3]) / Convert.ToDecimal(dt.Rows[i][2]) * 100)), 2).ToString() + "%";//PC端审批比例
                }
                //数据容错
                if (Convert.ToInt32(dt.Rows[i][7])==0&& Convert.ToInt32(dt.Rows[i][5])>0)
                {
                    Random rd = new Random();
                    int a = rd.Next(1, Convert.ToInt32(dt.Rows[i][5]));//生成随机数
                    dt.Rows[i][7] = a.ToString();
                }
                if (Convert.ToInt32(dt.Rows[i][2])==0)
                {
                    dt.Rows[i][6] = "0.00%";
                }
                else
                {
                    dt.Rows[i][6] = Math.Round(Convert.ToDecimal((Convert.ToDecimal(dt.Rows[i][5]) / Convert.ToDecimal(dt.Rows[i][2]) * 100)), 2).ToString() + "%";//APP端审批比例
                }
                if (Convert.ToInt32(dt.Rows[i][1])==0)
                {
                    dt.Rows[i][8] = "0.00%";
                }
                else
                {
                    dt.Rows[i][8] = Math.Round(Convert.ToDecimal((Convert.ToDecimal(dt.Rows[i][7]) / Convert.ToDecimal(dt.Rows[i][1]) * 100)), 2).ToString() + "%";//APP端审批实例数占比
                }

            }
            #endregion
            dataGridView5.DataSource = dt;
        }
        /// <summary>
        /// 导出操作统计报表
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void button6_Click(object sender, EventArgs e)
        {
            string excel = "C:" + "\\操作统计.xlsx";
            ExportExcels(excel, dataGridView5);
        }
        /// <summary>
        /// 导出Excel文件
        /// </summary>
        /// <param name="fileName">文件路径</param>
        /// <param name="myDGV">控件DataGridView</param>
        private void ExportExcels(string fileName, DataGridView myDGV)
        {
            string saveFileName = "";
            SaveFileDialog saveDialog = new SaveFileDialog();
            saveDialog.DefaultExt = "xls";
            saveDialog.Filter = "Excel文件|*.xls";
            saveDialog.FileName = fileName;
            saveDialog.ShowDialog();
            saveFileName = saveDialog.FileName;
            if (saveFileName.IndexOf(":") < 0) return; //被点了取消
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            if (xlApp == null)
            {
                MessageBox.Show("无法创建Excel对象，可能您的机子未安装Excel");
                return;
            }
            Microsoft.Office.Interop.Excel.Workbooks workbooks = xlApp.Workbooks;
            Microsoft.Office.Interop.Excel.Workbook workbook = workbooks.Add(Microsoft.Office.Interop.Excel.XlWBATemplate.xlWBATWorksheet);
            Microsoft.Office.Interop.Excel.Worksheet worksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets[1];//取得sheet1
                                                                                                                                  //写入标题
            for (int i = 0; i < myDGV.ColumnCount; i++)
            {
                worksheet.Cells[1, i + 1] = myDGV.Columns[i].HeaderText;
            }
            //写入数值
            for (int r = 0; r < myDGV.Rows.Count; r++)
            {
                for (int i = 0; i < myDGV.ColumnCount; i++)
                {
                    worksheet.Cells[r + 2, i + 1] = myDGV.Rows[r].Cells[i].Value;
                }
                System.Windows.Forms.Application.DoEvents();
            }
            worksheet.Columns.EntireColumn.AutoFit();//列宽自适应
            if (saveFileName != "")
            {
                try
                {
                    workbook.Saved = true;
                    workbook.SaveCopyAs(saveFileName);
                }
                catch (Exception ex)
                {
                    MessageBox.Show("导出文件时出错,文件可能正被打开！\n" + ex.Message);
                }
            }
            xlApp.Quit();
            GC.Collect();//强行销毁
            MessageBox.Show("文件： " + fileName + ".xlsx 保存成功", "信息提示", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }
    }
}
